udmps99 - intérprete de máquina de pila simbólica UDMPs99

Copyright (C) 1997, 1998, 1999, 2007, 2008, 2009, 2011
The UDMPs99 team (Universidad de Deusto)

The UDMPs99 team: Andoni Eguíluz, JosuKa Díaz
(Departamento de Ingeniería Informática, Facultad de Ingeniería)
and Jesús Redrado, Jorge García, Ana Cabana, Sergio Argüello, David Vázquez,
Igor Ruiz, David Ausín, Endika Gutiérrez, Luis Rodríguez

v.1.0ß 19990419
v.1.1ß 20110318

0. Distribución
---------------
+ udmps99
  - README       este fichero
  + bin          ejecutables precompilados
    + linux32    para GNU/Linux (32 bits)
    + linux64    para GNU/Linux (64 bits)
    + win32      para MS-Windows (32 bits)
    + win64      para MS-Windows (64 bits)
  + src          código fuente
    + include    cabecera de flex
  + test         ejemplos de prueba
  - udmps99.pdf  documentación (en PDF)

1. Uso
------
El intérprete del lenguaje de máquina de pila ejecuta los programas de máquina
de pila, que se supone residen en archivos con la extensión '.mpv'. Así:

udmps99 miprog

ejecutará el programa del archivo 'miprog.mpv'. El intérprete procesa el
programa (si encuentra errores, informa de ello, y además genera el archivo
'miprog.err'), y genera un archivo llamado 'miprog.mpn', en lenguaje de
máquina de pila no simbólica, que es lo que realmente se ejecuta.

Existen mínimas ayudas de depuración. Para empezar, las operaciones de entrada
y salida se duplican en el archivo 'miprog.out'. Por otro lado, si se ejecuta:

udmps99 miprog -d

se genera un archivo 'miprog.log', donde se escribe cada instrucción según se
va ejecutando. Si el programa de máquina de pila no se ejecuta como se espera,
puede verse en tal archivo lo que está pasando. Sin embargo, esperamos que no
sea una gran noticia que advirtamos de lo peligrosa que puede llegar a ser
esta última opción.

2. Instalación
--------------
En GNU/Linux, se proporciona una imagen ejecutable 'udmps99' en el directorio
'udmps99/bin/linux32'. Puede copiarse al directorio '/usr/bin/' o similar para
ejecutar el intérprete en cualquier directorio.

En MS-Windows (versiones de 32 bits), copiar el fichero 'udmps99.exe' del
directorio 'udmps99\bin\win32' al directorio donde se vayan a ejecutar los
programas de máquina de pila. También puede copiarse a algún directorio que
esté en el PATH, para poder interpretar programas de máquina de pila en
cualquier lugar. Para MS-Windows (versiones de 64 bits), usar el ejecutable
del directorio 'udmps99\bin\win64'.

3. Obtención de ejecutables
---------------------------
El directorio 'src' contienen los ficheros fuente, junto con las indicaciones
necesarias para la compilación.

Para GNU/Linux, se proporciona archivo 'Makefile', por lo que un simple:

make

ejectuado en el directorio 'udmps99/src' debería generar la imagen ejecutable
'udmps99'. Si se escribe:

make clean

se borrarán todos los archivos .o generados. El ejecutable distribuido en el
directorio 'udmps99/bin/linux32' se ha compilado con GCC 4.4.3.

Para MS-Windows, se proporcionan archivos .bat para diferentes entornos de
desarrollo, como MinGW, Visual Studio o DJGPP. Los ejecutables distribuidos
en los directorios 'udmps99\bin\win32' y 'udmps99\bin\win64' se han compilado
con Visual Studio 2010.

UDMPs99 utiliza flex para procesar los programas '.mpv'. El directorio 'src'
contiene el archivo 'udmps99.lex' con la especificación léxica, que permite
generar el fichero fuente 'lexyy.cpp' mediante la orden:

flex --nounistd udmps99.lex

En realidad, nos hubiera gustado no tener que recurrir a la opción
'--nounistd', usando en su lugar la directiva '%nounistd' dentro del programa
'udmps99.lex', pero ocurre que se trata de un "bug" de la versión actual de
flex (2.5.35, por cierto, heredado según parece de versiones anteriores), con
lo que dicha directiva no es procesada correctamente.

La regeneración del archivo 'lexyy.cpp' no se incluye ni en el 'Makefile' de
GNU/Linux ni en los .bat de compilación de MS-Windows, evitando entre otras
cosas la necesidad de instalar flex. Si se hicieran cambios en el fuente
'udmps99.lex', sí sería necesaria la regeneración de 'lexyy.cpp' mediante la
orden escrita más arriba.

Independientemente de lo anterior, el archivo 'lexyy.cpp' incluye el archivo
de cabecera 'FlexLexer.h'. El archivo usado para obtener los ejecutables de
esta distribución se incluye en el directorio 'udmps99/src/include' y es el
que se distribuye con la versión 2.5.35 de flex, lo que debería servir para
regenerar UDMPs99 en un sistema sin instalar flex, usando el 'Makefile' o los
'.bat' que se proporcionan.

Sin embargo, en un sistema que tuviera instalada una versión de flex con una
versión diferente del archivo 'FlexLexer.h', existiría el riesgo de errores
debidos a una posible incompatibilidad de las versiones. Por ello, en este
caso, para regenerar el sistema, se recomienda o bien asegurarse que se incluye
la cabecera 'FlexLexer.h' de la versión 2.5.35 proporcionada, o bien regenerar
'lexyy.cpp' a partir de 'udmps99.lex' con la misma versión de flex del archivo
'FlexLexer.h' que luego se incluya al compilar los programas C++. Por supuesto,
el efecto de usar una versión de flex anterior a 2.5.35 es desconocido.

4. Pruebas
----------
El directorio 'udmps99/test' contiene un pequeño repertorio de archivos '.mpv'
de prueba, algunos de los cuales producen errores de compilación, mientras que
otros deberían ejecutarse con normalidad. Se ha incluido un lanzador que
explica someramente el resultado esperado de la ejecución del intérprete. En
GNU/Linux, en dicho directorio, se lanza mediante:

./00runtest.sh

mientras que en MS-Windows es:

00runtest.bat

la orden que lanza los programas de prueba.

5. Errores y mejoras
--------------------
Existen con toda seguridad, es decir, más allá de la certeza de que cualquier
programa puede contener errores, en este caso tenemos plena constancia de que
hay todavía unos cuantos, pese a haber realizado un esfuerzo considerable para
la eliminación de muchos errores de la versión original de 1999.

En particular, tenemos dudas acerca del comportamiento correcto del intérprete
en sistemas de 64 bits, porque aunque la máquina de pila UDMPs99 es
estrictamente una máquina de 32 bits, aún albergamos sospechas sobre el manejo
de direcciones.

6. Contacto
-----------
Errores, sugerencias, mejoras, etc. serán bienvenidas:

JosuKa Díaz Labrador
josuka en deusto punto es
http://paginaspersonales.deusto.es/josuka/

X. Licencia
-----------
UDMPs99 is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

UDMPs99 is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Foobar.  If not, see <http://www.gnu.org/licenses/>.
